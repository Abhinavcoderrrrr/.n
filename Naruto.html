<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naruto Classic Episodes</title>
    <!-- Favicon -->
    <link rel="icon" href="logo.png" type="image/png">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Favicon X-Images library -->
    <link rel="apple-touch-icon" sizes="180x180" href="logo.png">
    <link rel="icon" type="image/png" sizes="32x32" href="logo.png">
    <link rel="icon" type="image/png" sizes="16x16" href="logo.png">
    <meta name="msapplication-TileImage" content="logo.png">
    <style>
        body {
            background-color: #FFA500;
            /* Orange background for Naruto theme */
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
        }

        .navbar {
            background-color: #FF6200 !important;
            /* Darker orange for navbar */
        }

        .navbar-brand {
            font-weight: bold;
            font-size: 1.5rem;
        }

        .navbar-brand img {
            height: 30px;
            margin-right: 10px;
            border-radius: 50%;
            background-color: #FFA500;
            padding: 2px;
            border: 2px solid #FF6200;
        }

        .page-header {
            background-image: url('posternarutoclassic.jpg');
            background-size: cover;
            background-position: center;
            color: white;
            text-align: center;
            padding: 80px 0;
            margin-bottom: 40px;
            position: relative;
        }

        .page-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .page-header-content {
            position: relative;
            z-index: 1;
        }

        .card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 25px;
            border: none;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            cursor: pointer;
        }

        .card-title {
            font-weight: bold;
            color: #FF6200;
        }

        .card-img-container {
            position: relative;
            padding-top: 56.25%;
            /* 16:9 aspect ratio */
            background-color: #000;
        }

        .card-img-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            background-color: #333;
        }

        .footer {
            background-color: #333;
            color: white;
            padding: 20px 0;
            margin-top: 40px;
        }

        /* Subscription badge */
        .subscription-badge {
            position: fixed;
            top: 80px;
            right: 10px;
            background: linear-gradient(135deg, #FFA500, #FF6200);
            color: white;
            padding: 10px 15px;
            border-radius: 50px;
            font-weight: bold;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            display: flex;
            align-items: center;
        }

        .countdown-container {
            margin-left: 10px;
            font-family: monospace;
        }
    </style>
</head>

<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="index.html">Naruto Anime</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="Naruto.html">Naruto Classic (<span
                                id="naruto-count">0</span>)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="NarutoShippuden.html">Naruto Shippuden (<span
                                id="shippuden-count">0</span>)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Boruto.html">Boruto (<span id="boruto-count">0</span>)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="history.html">History</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Subscription Badge (shown when active) -->
    <div class="subscription-badge" id="subscription-badge" style="display: none;">
        <i class="bi bi-stars"></i> Premium Active
        <span class="countdown-container" id="subscription-time">23:59:59</span>
        <button id="remove-subscription" class="btn btn-sm btn-danger ms-2"
            style="border-radius: 50px; font-size: 0.8rem;">
            <i class="bi bi-x-circle"></i>
        </button>
    </div>

    <!-- Page Header -->
    <header class="page-header">
        <div class="page-header-content">
            <h1 class="display-4">Naruto Classic</h1>
            <p class="lead">Watch all 220 episodes of the original Naruto series</p>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row" id="episode-container">
            <!-- Episode cards will be dynamically created -->
        </div>

        <!-- Admin Subscription Tool (Hidden by default) -->
        <div class="text-center mt-5 mb-5">
            <button id="admin-button" class="btn btn-dark" style="opacity: 0.3;" onclick="toggleAdminTools()">
                <i class="bi bi-shield-lock"></i>
            </button>

            <div id="admin-tools" style="display: none; margin-top: 20px;" class="p-4 bg-dark rounded text-white">
                <h5>Admin Subscription Tools</h5>
                <div class="row mt-3">
                    <div class="col-md-6">
                        <div class="input-group mb-3">
                            <span class="input-group-text">Hours</span>
                            <input type="number" id="subscription-hours" class="form-control" value="24" min="1"
                                max="720">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <button class="btn btn-success w-100" onclick="createAdminSubscription()">
                            <i class="bi bi-check-circle"></i> Create Subscription
                        </button>
                    </div>
                </div>
                <div class="mt-3">
                    <button class="btn btn-danger" onclick="removeSubscription()">
                        <i class="bi bi-x-circle"></i> Remove Subscription
                    </button>
                    <button class="btn btn-secondary ms-2" onclick="toggleAdminTools()">
                        <i class="bi bi-box-arrow-left"></i> Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Episode Data and Card Generation -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            console.log("DOM Content Loaded - Initializing Naruto page");

            // Update subscription badge if subscription exists
            updateSubscriptionBadge();

            // Setup remove subscription button
            document.getElementById('remove-subscription').addEventListener('click', function (e) {
                e.stopPropagation(); // Prevent event bubbling

                if (confirm('Are you sure you want to remove your premium subscription?')) {
                    // Remove subscription from localStorage
                    localStorage.removeItem('narutoSubscription');

                    // Hide the badge
                    document.getElementById('subscription-badge').style.display = 'none';

                    // Show confirmation
                    alert('Your premium subscription has been removed.');
                }
            });

            // Define Google Drive links for episodes - Include full URLs for easy updating
            const episodeLinks = {
                1: "https://drive.google.com/file/d/1P-ol8Xmr7wH3V7AWrGUKPjuqQuWktqdz/view?usp=sharing",
                2: "https://drive.google.com/file/d/1pRd8-zvUoO4q7DjfG4rPFWy3MBgkjTgy/view?usp=sharing",
                3: "https://drive.google.com/file/d/1YO2u9PiXaugCdMHK-LneZs9MD9JRAHOR/view?usp=sharing",
                4: "https://drive.google.com/file/d/1QDdhEz8p0EX6MFF_DjIup3QBf5169hAY/view?usp=sharing",
                5: "https://drive.google.com/file/d/1PeHszLrHpyNL43a1SnmMUIhasVq-PuAO/view?usp=sharing",
                6: "https://drive.google.com/file/d/1aSUi1hy5jDtObU35fFTvIo9GX1Ny1lgU/view?usp=sharing",
                7: "https://drive.google.com/file/d/1UIxj4uYYmXdOuh4mVMvLXqZwhMzcOM6h/view?usp=sharing",
                8: "https://drive.google.com/file/d/1ObZno2NxTqZj8_o6lEnvdNDlMDXNqG-M/view?usp=sharing",
                9: "https://drive.google.com/file/d/1OdNts24NfNwutvB6wFqDpYYiyJGOt-3k/view?usp=sharing",
                10: "https://drive.google.com/file/d/1OhXTYTopPcUnupAp32rRIKQWnUvy4VcU/view?usp=sharing",
                11: "https://drive.google.com/file/d/1P0C6dZMbb7nogNg1z08Vioup8BjCIrcp/view?usp=sharing",
                12: "https://drive.google.com/file/d/1Ol8o0JcPtl23Z5HCwDPFrom7YHZUBF90/view?usp=sharing",
                13: "https://drive.google.com/file/d/1P1epmQtlZT4yIs3GMo6lwVhh2b4IKmyF/view?usp=sharing",
                14: "https://drive.google.com/file/d/1PA1N5KAf4HcOLadOsTTDe34Vykth316T/view?usp=sharing",
                15: "https://drive.google.com/file/d/1PAL8yuUXwuazjr2EH40cRYZVmeEuGsPO/view?usp=sharing",
                16: "https://drive.google.com/file/d/1Ohy0HNWSOn_G89SymkW7hMLI4Re-pZ2A/view?usp=sharing",
                17: "https://drive.google.com/file/d/1PDLtaiw9a9Zmh5bSbUY0Ye1OtdueBxmo/view?usp=sharing",
                18: "",
                19: "",
                20: "",
                21: "",
                22: "",
                23: "",
                24: "",
                25: "",
                26: "",
                27: "",
                28: "",
                29: "",
                30: "",
                31: "",
                32: "",
                33: "",
                34: "",
                35: "",
                36: "",
                37: "",
                38: "",
                39: "",
                40: "",
                41: "",
                42: "",
                43: "",
                44: "",
                45: "",
                46: "",
                47: "",
                48: "",
                49: "",
                50: "",
                51: "",
                52: "",
                53: "",
                54: "",
                55: "",
                56: "",
                57: "",
                58: "",
                59: "",
                60: "",
                61: "",
                62: "",
                63: "",
                64: "",
                65: "",
                66: "",
                67: "",
                68: "",
                69: "",
                70: "",
                71: "",
                72: "",
                73: "",
                74: "",
                75: "",
                76: "",
                77: "",
                78: "",
                79: "",
                80: "",
                81: "",
                82: "",
                83: "",
                84: "",
                85: "",
                86: "",
                87: "",
                88: "",
                89: "",
                90: "",
                91: "",
                92: "",
                93: "",
                94: "",
                95: "",
                96: "",
                97: "",
                98: "",
                99: "",
                100: "",
                101: "",
                102: "",
                103: "",
                104: "",
                105: "",
                106: "",
                107: "",
                108: "",
                109: "",
                110: "",
                111: "",
                112: "",
                113: "",
                114: "",
                115: "",
                116: "",
                117: "",
                118: "",
                119: "",
                120: "",
                121: "",
                122: "",
                123: "",
                124: "",
                125: "",
                126: "",
                127: "",
                128: "",
                129: "",
                130: "",
                131: "",
                132: "",
                133: "",
                134: "",
                135: "",
                136: "",
                137: "",
                138: "",
                139: "",
                140: "",
                141: "",
                142: "",
                143: "",
                144: "",
                145: "",
                146: "",
                147: "",
                148: "",
                149: "",
                150: "",
                151: "",
                152: "",
                153: "",
                154: "",
                155: "",
                156: "",
                157: "",
                158: "",
                159: "",
                160: "",
                161: "",
                162: "",
                163: "",
                164: "",
                165: "",
                166: "",
                167: "",
                168: "",
                169: "",
                170: "",
                171: "",
                172: "",
                173: "",
                174: "",
                175: "",
                176: "",
                177: "",
                178: "",
                179: "",
                180: "",
                181: "",
                182: "",
                183: "",
                184: "",
                185: "",
                186: "",
                187: "",
                188: "",
                189: "",
                190: "",
                191: "",
                192: "",
                193: "",
                194: "",
                195: "",
                196: "",
                197: "",
                198: "",
                199: "",
                200: "",
                201: "",
                202: "",
                203: "",
                204: "",
                205: "",
                206: "",
                207: "",
                208: "",
                209: "",
                210: "",
                211: "",
                212: "",
                213: "",
                214: "",
                215: "",
                216: "",
                217: "",
                218: "",
                219: "",
                220: "",
            };

            // Process the links to extract file IDs and update localStorage
            let narutoEpisodes = JSON.parse(localStorage.getItem('narutoEpisodes') || '{}');
            let updated = false;

            // Process each episode link
            for (const [episodeNumber, link] of Object.entries(episodeLinks)) {
                if (link) {
                    const fileId = extractFileIdFromLink(link);
                    if (fileId) {
                        // Only update if the fileId is different or not present
                        if (narutoEpisodes[episodeNumber] !== fileId) {
                            narutoEpisodes[episodeNumber] = fileId;
                            updated = true;
                        }
                    }
                }
            }

            // Save to localStorage if changes were made
            if (updated) {
                localStorage.setItem('narutoEpisodes', JSON.stringify(narutoEpisodes));
                console.log('Updated episode data in localStorage');
            }

            // Create episode data object from localStorage
            createEpisodeCards(narutoEpisodes);

            // Update episode counts in the navigation
            updateAllEpisodeCounts();
        });

        // Extract file ID from Google Drive link
        function extractFileIdFromLink(link) {
            // Match patterns like https://drive.google.com/file/d/FILEID/view
            const match = link.match(/\/file\/d\/([^\/]+)/);
            if (match && match[1]) {
                return match[1];
            }

            // Match patterns like https://drive.google.com/open?id=FILEID
            const idMatch = link.match(/[?&]id=([^&]+)/);
            if (idMatch && idMatch[1]) {
                return idMatch[1];
            }

            return null;
        }

        // Function to play episode
        function playEpisode(episodeNumber) {
            // Instead of directly using fileId, we'll use our secure API
            // The actual video URL/fileId will be fetched securely on the player page
            window.location.href = `player.html?series=naruto&episode=${episodeNumber}`;
        }

        // Function to create episode card
        function createEpisodeCard(episodeNumber) {
            const col = document.createElement('div');
            col.className = 'col-6 col-md-3';

            col.innerHTML = `
                <div class="card" onclick="playEpisode(${episodeNumber})">
                        <div class="card-img-container">
                            <div class="card-img-placeholder">
                                <img src="posternarutoclassic.jpg" alt="Naruto Logo" style="max-width: 100%; max-height: 100%; object-fit: contain;">
                            </div>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">Episode ${episodeNumber}</h5>
                        </div>
                    </div>
                `;

            return col;
        }

        // Generate all episode cards
        function createEpisodeCards(episodeData) {
            const container = document.getElementById('episode-container');

            // Clear existing cards
            container.innerHTML = '';

            // Show all 220 episodes
            for (let episodeNumber = 1; episodeNumber <= 220; episodeNumber++) {
                const fileId = episodeData[episodeNumber] || '';
                const card = createEpisodeCard(episodeNumber);
                card.id = 'episode-' + episodeNumber; // Add ID for direct navigation
                container.appendChild(card);
            }

            // Update count in the page header to fixed value
            const pageHeaderLead = document.querySelector('.page-header .lead');
            if (pageHeaderLead) {
                pageHeaderLead.textContent = `Watch all 220 episodes of the original Naruto series`;
            }

            return 220;
        }

        // Handle direct navigation via URL hash
        if (window.location.hash) {
            const episodeId = window.location.hash.substring(1); // Remove the # character
            const episodeElement = document.getElementById(episodeId);

            if (episodeElement) {
                // Scroll to the episode
                setTimeout(() => {
                    episodeElement.scrollIntoView({ behavior: 'smooth', block: 'center' });

                    // Highlight the episode card
                    const card = episodeElement.querySelector('.card');
                    if (card) {
                        card.style.boxShadow = '0 0 15px 5px rgba(255, 165, 0, 0.7)';
                        card.style.transform = 'translateY(-5px)';

                        // Remove highlight after 3 seconds
                        setTimeout(() => {
                            card.style.boxShadow = '';
                            card.style.transform = '';
                        }, 3000);
                    }
                }, 500);
            }
        }

        // Update subscription badge
        function updateSubscriptionBadge() {
            const subscription = JSON.parse(localStorage.getItem('narutoSubscription') || 'null');
            const badge = document.getElementById('subscription-badge');

            if (subscription && subscription.expiryDate) {
                const now = new Date().getTime();
                const expiryTime = new Date(subscription.expiryDate).getTime();

                if (now < expiryTime) {
                    // Calculate time remaining
                    const timeRemaining = expiryTime - now;
                    const hoursRemaining = Math.floor(timeRemaining / (1000 * 60 * 60));
                    const minutesRemaining = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
                    const secondsRemaining = Math.floor((timeRemaining % (1000 * 60)) / 1000);

                    // Update badge text
                    document.getElementById('subscription-time').textContent =
                        `${hoursRemaining.toString().padStart(2, '0')}:${minutesRemaining.toString().padStart(2, '0')}:${secondsRemaining.toString().padStart(2, '0')}`;

                    // Show badge
                    badge.style.display = 'flex';

                    // Update the badge every second
                    setTimeout(updateSubscriptionBadge, 1000);
                } else {
                    // Hide badge if subscription expired
                    badge.style.display = 'none';
                    localStorage.removeItem('narutoSubscription');
                }
            } else {
                // No subscription
                badge.style.display = 'none';
            }
        }

        // Function to update all episode counts across the site
        function updateAllEpisodeCounts() {
            // Set fixed counts as requested
            document.getElementById('naruto-count').textContent = '220';
            document.getElementById('shippuden-count').textContent = '500';
            document.getElementById('boruto-count').textContent = '293';
        }

        // Admin Subscription Tools
        function toggleAdminTools() {
            const adminTools = document.getElementById('admin-tools');
            if (adminTools.style.display === 'none') {
                adminTools.style.display = 'block';
            } else {
                adminTools.style.display = 'none';
            }
        }

        function createAdminSubscription() {
            // Get hours from input
            const hours = parseInt(document.getElementById('subscription-hours').value) || 24;

            // Calculate expiry time
            const now = new Date();
            const expiryDate = new Date(now.getTime() + hours * 60 * 60 * 1000); // hours to milliseconds

            // Create subscription object
            const subscription = {
                active: true,
                createdAt: now.toISOString(),
                expiryDate: expiryDate.toISOString()
            };

            // Save to localStorage
            localStorage.setItem('narutoSubscription', JSON.stringify(subscription));

            // Update the badge immediately
            updateSubscriptionBadge();

            // Show confirmation
            alert(`Subscription created successfully! Valid for ${hours} hours.`);
        }

        function removeSubscription() {
            // Remove subscription from localStorage
            localStorage.removeItem('narutoSubscription');

            // Hide the badge
            document.getElementById('subscription-badge').style.display = 'none';

            // Show confirmation
            alert('Subscription removed successfully.');
        }
    </script>

    <!-- Bootstrap JS and Icons -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
</body>

</html>