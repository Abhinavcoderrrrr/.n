<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naruto Classic Episodes</title>
    <!-- Favicon -->
    <link rel="icon" href="logo.png" type="image/png">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Favicon X-Images library -->
    <link rel="apple-touch-icon" sizes="180x180" href="logo.png">
    <link rel="icon" type="image/png" sizes="32x32" href="logo.png">
    <link rel="icon" type="image/png" sizes="16x16" href="logo.png">
    <meta name="msapplication-TileImage" content="logo.png">
    <style>
        body {
            background-color: #FFA500;
            /* Orange background for Naruto theme */
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
            overflow: scroll;
        }
        
        .navbar {
            background-color: #FF6200 !important;
            /* Darker orange for navbar */
        }
        
        .navbar-brand {
            font-weight: bold;
            font-size: 1.5rem;
        }

        .navbar-brand img {
            height: 30px;
            margin-right: 10px;
            border-radius: 50%;
            background-color: #FFA500;
            padding: 2px;
            border: 2px solid #FF6200;
        }
        
        /* Season dropdown styling */
        .season-dropdown-card {
            border: none;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        
        .season-dropdown-card .card-header {
            cursor: pointer;
            padding: 15px 20px;
            border-bottom: none;
            transition: all 0.3s ease;
        }
        
        .season-dropdown-card .card-header:hover {
            background-color: #FFB74D !important;
        }
        
        .dropdown-icon {
            transition: transform 0.4s ease;
            font-size: 1.2rem;
        }
        
        .dropdown-icon.active {
            transform: rotate(-180deg);
        }
        
        .dropdown-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
            padding: 0 !important;
            margin: 0;
            border-top: 0;
        }
        
        .dropdown-content.show {
            max-height: 500px;
            overflow-y: auto;
            padding: 1rem !important;
        }
        
        .season-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .season-option {
            display: flex;
            padding: 12px 15px;
            border-radius: 8px;
            background-color: #FFF2E0;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid #FF6200;
        }
        
        .season-option:hover {
            background-color: #FFE0B2;
            transform: translateX(5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .season-number {
            font-weight: bold;
            color: #FF6200;
            margin-right: 15px;
            padding: 5px 10px;
            background-color: rgba(255, 98, 0, 0.1);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 80px;
        }
        
        .season-details {
            flex: 1;
        }
        
        .season-name {
            font-weight: 600;
            color: #333;
        }
        
        .season-episodes {
            color: #666;
            font-size: 0.9rem;
            margin-top: 3px;
        }
        
        .page-header {
            background-image: url('posternarutoclassic.jpg');
            background-size: cover;
            background-position: center;
            color: white;
            text-align: center;
            padding: 80px 0;
            margin-bottom: 40px;
            position: relative;
        }
        
        .page-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .page-header-content {
            position: relative;
            z-index: 1;
        }
        
        .card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 25px;
            border: none;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            cursor: pointer;
        }
        
        .card-title {
            font-weight: bold;
            color: #FF6200;
        }
        
        .card-img-container {
            position: relative;
            padding-top: 56.25%;
            /* 16:9 aspect ratio */
            background-color: #000;
        }
        
        .card-img-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            background-color: #333;
        }
        
        .footer {
            background-color: #333;
            color: white;
            padding: 20px 0;
            margin-top: 40px;
        }
        
        /* Subscription badge */
        .subscription-badge {
            position: fixed;
            top: 80px;
            right: 10px;
            background: linear-gradient(135deg, #FFA500, #FF6200);
            color: white;
            padding: 10px 15px;
            border-radius: 50px;
            font-weight: bold;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            display: flex;
            align-items: center;
        }
        
        .countdown-container {
            margin-left: 10px;
            font-family: monospace;
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .navbar-brand {
                font-size: 1.2rem;
            }
            
            .page-header {
                padding: 50px 0;
                margin-bottom: 20px;
            }
            
            .page-header h1 {
                font-size: 2rem;
            }
            
            .page-header .lead {
                font-size: 1rem;
            }
            
            .card {
                margin-bottom: 15px;
            }
            
            .card-body {
                padding: 10px;
            }
            
            .card-title {
                font-size: 1rem;
                margin-bottom: 0;
            }
            
            .subscription-badge {
                padding: 8px 12px;
                top: 70px;
                right: 5px;
                font-size: 0.9rem;
            }
            
            .countdown-container {
                font-size: 0.9rem;
            }
            
            /* Admin tools mobile styling */
            #admin-tools {
                padding: 15px !important;
            }
            
            #admin-tools h5 {
                font-size: 1.1rem;
            }
            
            #admin-tools .btn {
                font-size: 0.9rem;
                padding: 6px 10px;
            }
            
            /* Make episode cards look better on small screens */
            .col-6 {
                padding-left: 5px;
                padding-right: 5px;
            }
            
            .row {
                margin-left: -5px;
                margin-right: -5px;
            }
            
            .dropdown-content {
                max-height: 0;
                visibility: hidden;
            }
            
            .dropdown-content.show {
                visibility: visible;
            }
        }
    </style>
</head>

<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="index.html">Naruto Anime</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="Naruto.html">Naruto Classic (<span
                                id="naruto-count">0</span>)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="NarutoShippuden.html">Naruto Shippuden (<span
                                id="shippuden-count">0</span>)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Boruto.html">Boruto (<span id="boruto-count">0</span>)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="history.html">History</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Subscription Badge (shown when active) -->
    <div class="subscription-badge" id="subscription-badge" style="display: none;">
        <i class="bi bi-stars"></i> Premium Active
        <span class="countdown-container" id="subscription-time">23:59:59</span>
        <button id="remove-subscription" class="btn btn-sm btn-danger ms-2"
            style="border-radius: 50px; font-size: 0.8rem;">
            <i class="bi bi-x-circle"></i>
        </button>
    </div>

    <!-- Page Header -->
    <header class="page-header">
        <div class="page-header-content">
            <h1 class="display-4">Naruto Classic</h1>
            <p class="lead">Watch all 220 episodes of the original Naruto series</p>
        </div>
    </header>

    <!-- Season/Arc Dropdown -->
    <div class="container mb-4">
        <div class="card season-dropdown-card">
            <div class="card-header bg-warning text-dark d-flex justify-content-between align-items-center" id="season-header" onclick="toggleDropdown()">
                <h5 class="mb-0">Naruto Classic Seasons & Arcs</h5>
                <i class="bi bi-chevron-down dropdown-icon"></i>
            </div>
            <div class="card-body dropdown-content" id="season-content">
                <div class="p-2">
                    <div class="season-options">
                        <div class="season-option" onclick="filterBySeason('1')">
                            <div class="season-number">Season 1</div>
                            <div class="season-details">
                                <div class="season-name">Introduction & Land of Waves Arc</div>
                                <div class="season-episodes">Episodes 1-52</div>
                            </div>
                        </div>
                        <div class="season-option" onclick="filterBySeason('2')">
                            <div class="season-number">Season 2</div>
                            <div class="season-details">
                                <div class="season-name">Chunin Exams & Konoha Crush Arc</div>
                                <div class="season-episodes">Episodes 53-104</div>
                            </div>
                        </div>
                        <div class="season-option" onclick="filterBySeason('3')">
                            <div class="season-number">Season 3</div>
                            <div class="season-details">
                                <div class="season-name">Search for Tsunade & Land of Tea Arc</div>
                                <div class="season-episodes">Episodes 105-156</div>
                            </div>
                        </div>
                        <div class="season-option" onclick="filterBySeason('4')">
                            <div class="season-number">Season 4</div>
                            <div class="season-details">
                                <div class="season-name">Sasuke Retrieval & Filler Arcs</div>
                                <div class="season-episodes">Episodes 157-220</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <div class="row" id="episode-container">
            <!-- Episode cards will be dynamically created -->
        </div>

        <!-- Admin Subscription Tool (Hidden by default) -->
        <div class="text-center mt-5 mb-5">
            <button id="admin-button" class="btn btn-dark" style="opacity: 0.3;" onclick="toggleAdminTools()">
                <i class="bi bi-shield-lock"></i>
            </button>

            <div id="admin-tools" style="display: none; margin-top: 20px;" class="p-4 bg-dark rounded text-white">
                <h5>Admin Subscription Tools</h5>
                <div class="row mt-3">
                    <div class="col-md-6">
                        <div class="input-group mb-3">
                            <span class="input-group-text">Hours</span>
                            <input type="number" id="subscription-hours" class="form-control" value="24" min="1"
                                max="720">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <button class="btn btn-success w-100" onclick="createAdminSubscription()">
                            <i class="bi bi-check-circle"></i> Create Subscription
                        </button>
                    </div>
                </div>
                <div class="mt-3">
                    <button class="btn btn-danger" onclick="removeSubscription()">
                        <i class="bi bi-x-circle"></i> Remove Subscription
                    </button>
                    <button class="btn btn-secondary ms-2" onclick="toggleAdminTools()">
                        <i class="bi bi-box-arrow-left"></i> Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Episode Data and Card Generation -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            console.log("DOM Content Loaded - Initializing Naruto page");

            // Update subscription badge if subscription exists
            updateSubscriptionBadge();
            
            // Setup remove subscription button
            document.getElementById('remove-subscription').addEventListener('click', function (e) {
                e.stopPropagation(); // Prevent event bubbling

                if (confirm('Are you sure you want to remove your premium subscription?')) {
                    // Remove subscription from localStorage
                    localStorage.removeItem('narutoSubscription');

                    // Hide the badge
                    document.getElementById('subscription-badge').style.display = 'none';

                    // Show confirmation
                    alert('Your premium subscription has been removed.');
                }
            });

            // Define Google Drive links for episodes - Include full URLs for easy updating
            const episodeLinks = {
                1: "https://vidstreaming.xyz/v/V2RG6YD4QbI9/",
                2: "https://vidstreaming.xyz/v/JPdjhxcflNYM/",
                3: "https://vidstreaming.xyz/v/DvWqZ3LCH1L2/",
                4: "https://vidstreaming.xyz/v/ywKpXc8VdC8k/",
                5: "https://vidstreaming.xyz/v/DrDLIUVZE3bm/",
                6: "https://vidstreaming.xyz/v/qBOtKaTM9Amz/",
                7: "https://vidstreaming.xyz/v/BfLjrBLjzpJH/",
                8: "https://vidstreaming.xyz/v/YJqONCjfwCL3/",
                9: "https://vidstreaming.xyz/v/GkRreLaIBUFm/",
                10: "https://vidstreaming.xyz/v/jcDxkKPhHe3X/",
                11: "https://vidstreaming.xyz/v/j1QM6tM08G4f/",
                12: "https://vidstreaming.xyz/v/YYPmwmT9EwY4/",
                13: "https://vidstreaming.xyz/v/y9Sy8GWHt37e/",
                14: "https://vidstreaming.xyz/v/CjKbAKEEVZMc/",
                15: "https://vidstreaming.xyz/v/37HOG2kVSIQS/",
                16: "https://vidstreaming.xyz/v/HrWwqYMg6kzi/",
                17: "https://vidstreaming.xyz/v/GkMgglJhtblI/",
                18: "https://vidstreaming.xyz/v/amd9KZ4HF3RZ/",
                19: "https://vidstreaming.xyz/v/UBW3DedHL5Un/",
                20: "https://vidstreaming.xyz/v/1c5lgt1rzdGo/",
                21: "https://vidstreaming.xyz/v/EQffZtly6mey/",
                22: "https://vidstreaming.xyz/v/VW3PimOLOnSD/",
                23: "https://vidstreaming.xyz/v/1eVxVQtTWwX3/",
                24: "https://vidstreaming.xyz/v/7853C9dRbGU6/",
                25: "https://vidstreaming.xyz/v/BpUYMeIJba3l/",
                26: "https://vidstreaming.xyz/v/De2FKG7BZCa7/",
                27: "https://vidstreaming.xyz/v/ExZa9NOdyTPB/",
                28: "https://vidstreaming.xyz/v/2wKyaZeLPrup/",
                29: "https://vidstreaming.xyz/v/XvnCxZMDgwjv/",
                30: "https://vidstreaming.xyz/v/7vteqzcuWaYR/",
                31: "https://vidstreaming.xyz/v/qP3nCTWyzwiq/",
                32: "https://vidstreaming.xyz/v/itI43jprfCK9/",
                33: "https://vidstreaming.xyz/v/k9BwLfmA3jex/",
                34: "https://vidstreaming.xyz/v/aNbAAnpUZxqL/",
                35: "https://vidstreaming.xyz/v/KrorfH5aTIjl/",
                36: "https://vidstreaming.xyz/v/4tu2BHcn3Dfb/",
                37: "https://vidstreaming.xyz/v/po4lV5n725Z9/",
                38: "https://vidstreaming.xyz/v/xrIJxpxJUGko/",
                39: "https://vidstreaming.xyz/v/vxRjX81T8oaZ/",
                40: "https://vidstreaming.xyz/v/XuqCkFd5tuS2/",
                41: "https://vidstreaming.xyz/v/lI4NEy6iyTJC/",
                42: "https://vidstreaming.xyz/v/CIKTvFaNqZPD/",
                43: "https://vidstreaming.xyz/v/QNXIPaMKkq1n/",
                44: "https://vidstreaming.xyz/v/ZXTp77GReebx/",
                45: "https://vidstreaming.xyz/v/pGHjG5rCNYdk/",
                46: "https://vidstreaming.xyz/v/KDcb8QPEkE50/",
                47: "https://vidstreaming.xyz/v/3qV1J6SS1rOi/",
                48: "https://vidstreaming.xyz/v/inm4wppNEeqo/",
                49: "https://vidstreaming.xyz/v/MSKG9Fv3gFUo/",
                50: "https://vidstreaming.xyz/v/yBhRVxMHWvwW/",
                51: "https://vidstreaming.xyz/v/q3Qoop95qBhv/",
                52: "https://vidstreaming.xyz/v/S82Gi1Ce9lSH/",
                53: "",
                54: "",
                55: "",
                56: "",
                57: "",
                58: "",
                59: "",
                60: "",
                61: "",
                62: "",
                63: "",
                64: "",
                65: "",
                66: "",
                67: "",
                68: "",
                69: "",
                70: "",
                71: "",
                72: "",
                73: "",
                74: "",
                75: "",
                76: "",
                77: "",
                78: "",
                79: "",
                80: "",
                81: "",
                82: "",
                83: "",
                84: "",
                85: "",
                86: "",
                87: "",
                88: "",
                89: "",
                90: "",
                91: "",
                92: "",
                93: "",
                94: "",
                95: "",
                96: "",
                97: "",
                98: "",
                99: "",
                100: "",
                101: "",
                102: "",
                103: "",
                104: "",
                105: "",
                106: "",
                107: "",
                108: "",
                109: "",
                110: "",
                111: "",
                112: "",
                113: "",
                114: "",
                115: "",
                116: "",
                117: "",
                118: "",
                119: "",
                120: "",
                121: "",
                122: "",
                123: "",
                124: "",
                125: "",
                126: "",
                127: "",
                128: "",
                129: "",
                130: "",
                131: "",
                132: "",
                133: "",
                134: "",
                135: "",
                136: "",
                137: "",
                138: "",
                139: "",
                140: "",
                141: "",
                142: "",
                143: "",
                144: "",
                145: "",
                146: "",
                147: "",
                148: "",
                149: "",
                150: "",
                151: "",
                152: "",
                153: "",
                154: "",
                155: "",
                156: "",
                157: "",
                158: "",
                159: "",
                160: "",
                161: "",
                162: "",
                163: "",
                164: "",
                165: "",
                166: "",
                167: "",
                168: "",
                169: "",
                170: "",
                171: "",
                172: "",
                173: "",
                174: "",
                175: "",
                176: "",
                177: "",
                178: "",
                179: "",
                180: "",
                181: "",
                182: "",
                183: "",
                184: "",
                185: "",
                186: "",
                187: "",
                188: "",
                189: "",
                190: "",
                191: "",
                192: "",
                193: "",
                194: "",
                195: "",
                196: "",
                197: "",
                198: "",
                199: "",
                200: "",
                201: "",
                202: "",
                203: "",
                204: "",
                205: "",
                206: "",
                207: "",
                208: "",
                209: "",
                210: "",
                211: "",
                212: "",
                213: "",
                214: "",
                215: "",
                216: "",
                217: "",
                218: "",
                219: "",
                220: "",
            };

            // Process the links to extract file IDs and update localStorage
            let narutoEpisodes = JSON.parse(localStorage.getItem('narutoEpisodes') || '{}');
            let updated = false;

            // Process each episode link
            for (const [episodeNumber, link] of Object.entries(episodeLinks)) {
                if (link) {
                    if (link.includes('vidstreaming.xyz') || link.includes('://') && !link.includes('drive.google.com')) {
                        // For external video hosts like vidstreaming.xyz, store the full URL
                        localStorage.setItem(`narutoEpisode_${episodeNumber}_fullUrl`, link);
                        
                        // Also store a placeholder file ID to indicate this episode has a link
                        if (narutoEpisodes[episodeNumber] !== 'external') {
                            narutoEpisodes[episodeNumber] = 'external';
                            updated = true;
                        }
                    } else {
                        // For Google Drive links, extract and store just the file ID
                        const fileId = extractFileIdFromLink(link);
                        if (fileId) {
                            // Only update if the fileId is different or not present
                            if (narutoEpisodes[episodeNumber] !== fileId) {
                                narutoEpisodes[episodeNumber] = fileId;
                                updated = true;
                            }
                            
                            // Remove any stored full URL for this episode since we're using Google Drive
                            localStorage.removeItem(`narutoEpisode_${episodeNumber}_fullUrl`);
                        }
                    }
                }
            }

            // Save to localStorage if changes were made
            if (updated) {
                localStorage.setItem('narutoEpisodes', JSON.stringify(narutoEpisodes));
                console.log('Updated episode data in localStorage');
            }

            // Create episode data object from localStorage
            createEpisodeCards(narutoEpisodes);

            // Filter episodes to show only Season 1 by default
            filterBySeason('1');

            // Update episode counts in the navigation
            updateAllEpisodeCounts();
        });

        // Extract file ID from Google Drive link
        function extractFileIdFromLink(link) {
            // Match patterns like https://drive.google.com/file/d/FILEID/view
            const match = link.match(/\/file\/d\/([^\/]+)/);
            if (match && match[1]) {
                return match[1];
            }

            // Match patterns like https://drive.google.com/open?id=FILEID
            const idMatch = link.match(/[?&]id=([^&]+)/);
            if (idMatch && idMatch[1]) {
                return idMatch[1];
            }

            return null;
        }

        // Function to play episode
        function playEpisode(episodeNumber) {
            // Check if user has premium access
            if (hasPremiumAccess()) {
                // If user has premium, go directly to player
                window.location.href = `player.html?series=naruto&episode=${episodeNumber}`;
            } else {
                // If no premium access, redirect to unlock page
                window.location.href = `unlock.html?series=naruto&episode=${episodeNumber}`;
            }
        }

        // Check if user has valid premium subscription
        function hasPremiumAccess() {
            const subscription = JSON.parse(localStorage.getItem('narutoSubscription') || 'null');
            
            if (subscription && subscription.expiryDate) {
                const now = new Date().getTime();
                const expiryTime = new Date(subscription.expiryDate).getTime();
                
                // Return true if subscription is valid (current time is before expiry)
                return now < expiryTime;
            }
            
            // No subscription or invalid
            return false;
        }
            
            // Function to create episode card
        function createEpisodeCard(episodeNumber) {
                const col = document.createElement('div');
                col.className = 'col-6 col-md-3';
                
                col.innerHTML = `
                <div class="card" onclick="playEpisode(${episodeNumber})">
                        <div class="card-img-container">
                            <div class="card-img-placeholder">
                                <img src="posternarutoclassic.jpg" alt="Naruto Logo" style="max-width: 100%; max-height: 100%; object-fit: contain;">
                            </div>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">Episode ${episodeNumber}</h5>
                        </div>
                    </div>
                `;
                
                return col;
            }
            
            // Generate all episode cards
        function createEpisodeCards(episodeData) {
            const container = document.getElementById('episode-container');
            
            // Clear existing cards
            container.innerHTML = '';

            // Show all 220 episodes
            for (let episodeNumber = 1; episodeNumber <= 220; episodeNumber++) {
                const fileId = episodeData[episodeNumber] || '';
                const card = createEpisodeCard(episodeNumber);
                card.id = 'episode-' + episodeNumber; // Add ID for direct navigation
                container.appendChild(card);
            }

            // Update count in the page header to fixed value
            const pageHeaderLead = document.querySelector('.page-header .lead');
            if (pageHeaderLead) {
                pageHeaderLead.textContent = `Watch all 220 episodes of the original Naruto series`;
            }

            return 220;
            }
            
            // Handle direct navigation via URL hash
            if (window.location.hash) {
                const episodeId = window.location.hash.substring(1); // Remove the # character
                const episodeElement = document.getElementById(episodeId);
                
                if (episodeElement) {
                    // Scroll to the episode
                    setTimeout(() => {
                        episodeElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        
                        // Highlight the episode card
                        const card = episodeElement.querySelector('.card');
                        if (card) {
                            card.style.boxShadow = '0 0 15px 5px rgba(255, 165, 0, 0.7)';
                            card.style.transform = 'translateY(-5px)';
                            
                            // Remove highlight after 3 seconds
                            setTimeout(() => {
                                card.style.boxShadow = '';
                                card.style.transform = '';
                            }, 3000);
                        }
                    }, 500);
            }
        }

        // Update subscription badge
        function updateSubscriptionBadge() {
            const subscription = JSON.parse(localStorage.getItem('narutoSubscription') || 'null');
            const badge = document.getElementById('subscription-badge');
            
            if (subscription && subscription.expiryDate) {
                const now = new Date().getTime();
                const expiryTime = new Date(subscription.expiryDate).getTime();
                
                if (now < expiryTime) {
                    // Calculate time remaining
                    const timeRemaining = expiryTime - now;
                    const hoursRemaining = Math.floor(timeRemaining / (1000 * 60 * 60));
                    const minutesRemaining = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
                    const secondsRemaining = Math.floor((timeRemaining % (1000 * 60)) / 1000);
                    
                    // Update badge text
                    document.getElementById('subscription-time').textContent = 
                        `${hoursRemaining.toString().padStart(2, '0')}:${minutesRemaining.toString().padStart(2, '0')}:${secondsRemaining.toString().padStart(2, '0')}`;
                    
                    // Show badge
                    badge.style.display = 'flex';
                    
                    // Update the badge every second
                    setTimeout(updateSubscriptionBadge, 1000);
                } else {
                    // Hide badge if subscription expired
                    badge.style.display = 'none';
                    localStorage.removeItem('narutoSubscription');
                }
            } else {
                // No subscription
                badge.style.display = 'none';
            }
        }

        // Function to update all episode counts across the site
        function updateAllEpisodeCounts() {
            // Set fixed counts as requested
            document.getElementById('naruto-count').textContent = '220';
            document.getElementById('shippuden-count').textContent = '500';
            document.getElementById('boruto-count').textContent = '293';
        }

        // Admin Subscription Tools
        function toggleAdminTools() {
            const adminTools = document.getElementById('admin-tools');
            if (adminTools.style.display === 'none') {
                adminTools.style.display = 'block';
            } else {
                adminTools.style.display = 'none';
            }
        }

        function createAdminSubscription() {
            // Get hours from input
            const hours = parseInt(document.getElementById('subscription-hours').value) || 24;

            // Calculate expiry time
            const now = new Date();
            const expiryDate = new Date(now.getTime() + hours * 60 * 60 * 1000); // hours to milliseconds

            // Create subscription object
            const subscription = {
                active: true,
                createdAt: now.toISOString(),
                expiryDate: expiryDate.toISOString()
            };

            // Save to localStorage
            localStorage.setItem('narutoSubscription', JSON.stringify(subscription));

            // Update the badge immediately
            updateSubscriptionBadge();

            // Show confirmation
            alert(`Subscription created successfully! Valid for ${hours} hours.`);
        }

        function removeSubscription() {
            // Remove subscription from localStorage
            localStorage.removeItem('narutoSubscription');

            // Hide the badge
            document.getElementById('subscription-badge').style.display = 'none';

            // Show confirmation
            alert('Subscription removed successfully.');
        }

        // Function to toggle the dropdown visibility
        function toggleDropdown() {
            const dropdownContent = document.getElementById('season-content');
            const dropdownIcon = document.querySelector('.dropdown-icon');
            
            if (dropdownContent.classList.contains('show')) {
                dropdownContent.classList.remove('show');
                dropdownIcon.classList.remove('active');
            } else {
                dropdownContent.classList.add('show');
                dropdownIcon.classList.add('active');
            }
        }

        // Function to filter episodes by season and scroll to the first episode of that season
        function filterBySeason(seasonNumber) {
            const container = document.getElementById('episode-container');
            const cards = container.querySelectorAll('.col-6');
            
            // Define episode ranges for each season
            const seasonRanges = {
                '1': { start: 1, end: 52 },
                '2': { start: 53, end: 104 },
                '3': { start: 105, end: 156 },
                '4': { start: 157, end: 220 }
            };
            
            const range = seasonRanges[seasonNumber];
            
            // Hide all episodes first
            cards.forEach(card => {
                card.style.display = 'none';
            });
            
            // Show only episodes from the selected season
            for (let i = range.start; i <= range.end; i++) {
                const episodeCard = document.getElementById('episode-' + i);
                if (episodeCard) {
                    episodeCard.style.display = '';
                }
            }
            
            // Close the dropdown after selection
            const dropdownContent = document.getElementById('season-content');
            const dropdownIcon = document.querySelector('.dropdown-icon');
            dropdownContent.classList.remove('show');
            dropdownIcon.classList.remove('active');
            
            // Scroll to the first episode of the season
            const firstEpisode = document.getElementById('episode-' + range.start);
            if (firstEpisode) {
                firstEpisode.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Highlight the episode card
                const card = firstEpisode.querySelector('.card');
                if (card) {
                    card.style.boxShadow = '0 0 15px 5px rgba(255, 165, 0, 0.7)';
                    card.style.transform = 'translateY(-5px)';
                    
                    // Remove highlight after 3 seconds
                    setTimeout(() => {
                        card.style.boxShadow = '';
                        card.style.transform = '';
                    }, 3000);
                }
            }
        }
    </script>

    <!-- Bootstrap JS and Icons -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
</body>

</html> 